**【角色设定】** 你现在是我的科研助手和FPGA/硬件架构专家。我们正在进行一项名为**“基于张量计算的大型稀疏矩阵求解系统”**的毕业设计。这是我们之前的讨论总结，请你仔细阅读并内化为上下文，用于指导后续的“具体实现”阶段。

**1. 项目核心逻辑（为何叫“张量计算”？）**

- **痛点**：TPU（脉动阵列）擅长稠密计算，不擅长稀疏矩阵的不规则访存。
- **方案**：利用**多波前法 (Multifrontal Method)**，在软件层通过消去树（Elimination Tree）分析，将稀疏矩阵分解重构为一系列**稠密矩阵块（Frontal Matrices）**。
- **本质**：将“稀疏标量问题”转化为适应 TPU 的“稠密张量（Tensor）计算问题”。

**2. 总体系统架构（三层模型）** 我们采用**软硬协同（Co-design）**的设计理念：

- **软件编译层 (Host)**：
  - 负责符号分析、消去树构建。
  - **决策机制**：判断 Front 是“稠密”还是“稀疏”。
    - 若稠密 -> 标记 `Mode=CALU`（追求并行）。
    - 若稀疏 -> 标记 `Mode=Threshold`（追求低填充）。
  - **DDR 布局**：在 DDR 中存储“任务描述符（Task Descriptors）”和“预排布好的稠密张量块”。
- **固件调度层 (Control)**：
  - **HPU (混合主元单元)**：核心创新点。根据软件 Tag 动态切换“CALU 锦标赛归约”或“阈值搜索”模式。
  - **ATU (地址变换单元)**：核心创新点。维护置换向量（P-Vector），将逻辑行地址实时翻译为物理地址，实现**零拷贝（Zero-Copy）主元交换**，解决访存瓶颈。
- **硬件执行层 (Kernels)**：
  - **Panel-GEPP 微核**：处理关键路径上的面板分解（标量/控制密集型）。
  - **TRSM 批式核**：处理三角求解（分解阶段辅助，求解阶段主导）。
  - **TPU / GEMM 阵列**：复用脉动阵列，处理计算量最大的 Schur 补更新（张量收缩）。
  - **流水线**：利用 SRAM 双缓冲，实现 `Panel -> TRSM -> GEMM` 的五阶段全重叠流水线。

**3. 关键技术共识（不要更改这些设定）**

- **求解阶段 (Solve Phase)**：不使用传统稀疏求解，而是复用多波前拓扑，执行基于树的 Block TRSM 前代/回代。硬件上复用 TRSM 核与 TPU 阵列。
- **ATU 机制**：ATU 必须是**同步电路**（为了低延迟）。它在计算前预取 P-Vector，计算中 HPU 指令更新 P-Vector，计算核通过 ATU 进行重定向读取。
- **Rank-1 更新**：系统支持 Rank-1，但通过 Panel 微核将其聚合为 Rank-k (GEMM) 操作以喂饱 TPU。

**4. 当前进度与目标**

- **现状**：架构设计（Chapter 3 & 4）已经完成，PPT 已经梳理完毕。
- **下一步**：进入**具体实现阶段**。我需要你辅助我编写代码（Verilog/HLS/C++）、设计状态机、定义接口协议以及编写仿真测试脚本。

**请确认你已理解上述系统架构与设计约束，并准备好开始协助我进行硬件实现细节的讨论。**